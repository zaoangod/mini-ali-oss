const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="ARRAYBUFFER not supported by this environment",a="UINT8ARRAY not supported by this environment";function e(t,i,a,e){let n,o,p;const s=i||[0],l=(a=a||0)>>>3,c=-1===e?3:0;for(n=0;n<t.length;n+=1)p=n+l,o=p>>>2,s.length<=o&&s.push(0),s[o]|=t[n]<<8*(c+e*(p%4));return{value:s,binLen:8*t.length+a}}function n(n,o,p){switch(o){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(n){case"HEX":return function(t,i,a){return function(t,i,a,e){let n,o,p,s;if(0!=t.length%2)throw new Error("String of HEX type must be in byte increments");const l=i||[0],c=(a=a||0)>>>3,r=-1===e?3:0;for(n=0;n<t.length;n+=2){if(o=parseInt(t.substr(n,2),16),isNaN(o))throw new Error("String of HEX type contains invalid characters");for(s=(n>>>1)+c,p=s>>>2;l.length<=p;)l.push(0);l[p]|=o<<8*(r+e*(s%4))}return{value:l,binLen:4*t.length+a}}(t,i,a,p)};case"TEXT":return function(t,i,a){return function(t,i,a,e,n){let o,p,s,l,c,r,m,u,h=0;const d=a||[0],x=(e=e||0)>>>3;if("UTF8"===i)for(m=-1===n?3:0,s=0;s<t.length;s+=1)for(o=t.charCodeAt(s),p=[],128>o?p.push(o):2048>o?(p.push(192|o>>>6),p.push(128|63&o)):55296>o||57344<=o?p.push(224|o>>>12,128|o>>>6&63,128|63&o):(s+=1,o=65536+((1023&o)<<10|1023&t.charCodeAt(s)),p.push(240|o>>>18,128|o>>>12&63,128|o>>>6&63,128|63&o)),l=0;l<p.length;l+=1){for(r=h+x,c=r>>>2;d.length<=c;)d.push(0);d[c]|=p[l]<<8*(m+n*(r%4)),h+=1}else for(m=-1===n?2:0,u="UTF16LE"===i&&1!==n||"UTF16LE"!==i&&1===n,s=0;s<t.length;s+=1){for(o=t.charCodeAt(s),!0===u&&(l=255&o,o=l<<8|o>>>8),r=h+x,c=r>>>2;d.length<=c;)d.push(0);d[c]|=o<<8*(m+n*(r%4)),h+=2}return{value:d,binLen:8*h+e}}(t,o,i,a,p)};case"B64":return function(i,a,e){return function(i,a,e,n){let o,p,s,l,c,r,m,u=0;const h=a||[0],d=(e=e||0)>>>3,x=-1===n?3:0,f=i.indexOf("=");if(-1===i.search(/^[a-zA-Z0-9=+/]+$/))throw new Error("Invalid character in base-64 string");if(i=i.replace(/=/g,""),-1!==f&&f<i.length)throw new Error("Invalid '=' found in base-64 string");for(p=0;p<i.length;p+=4){for(c=i.substr(p,4),l=0,s=0;s<c.length;s+=1)o=t.indexOf(c.charAt(s)),l|=o<<18-6*s;for(s=0;s<c.length-1;s+=1){for(m=u+d,r=m>>>2;h.length<=r;)h.push(0);h[r]|=(l>>>16-8*s&255)<<8*(x+n*(m%4)),u+=1}}return{value:h,binLen:8*u+e}}(i,a,e,p)};case"BYTES":return function(t,i,a){return function(t,i,a,e){let n,o,p,s;const l=i||[0],c=(a=a||0)>>>3,r=-1===e?3:0;for(o=0;o<t.length;o+=1)n=t.charCodeAt(o),s=o+c,p=s>>>2,l.length<=p&&l.push(0),l[p]|=n<<8*(r+e*(s%4));return{value:l,binLen:8*t.length+a}}(t,i,a,p)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(t){throw new Error(i)}return function(t,i,a){return function(t,i,a,n){return e(new Uint8Array(t),i,a,n)}(t,i,a,p)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(t){throw new Error(a)}return function(t,i,a){return e(t,i,a,p)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function o(e,n,o,p){switch(e){case"HEX":return function(t){return function(t,i,a,e){const n="0123456789abcdef";let o,p,s="";const l=i/8,c=-1===a?3:0;for(o=0;o<l;o+=1)p=t[o>>>2]>>>8*(c+a*(o%4)),s+=n.charAt(p>>>4&15)+n.charAt(15&p);return e.outputUpper?s.toUpperCase():s}(t,n,o,p)};case"B64":return function(i){return function(i,a,e,n){let o,p,s,l,c,r="";const m=a/8,u=-1===e?3:0;for(o=0;o<m;o+=3)for(l=o+1<m?i[o+1>>>2]:0,c=o+2<m?i[o+2>>>2]:0,s=(i[o>>>2]>>>8*(u+e*(o%4))&255)<<16|(l>>>8*(u+e*((o+1)%4))&255)<<8|c>>>8*(u+e*((o+2)%4))&255,p=0;p<4;p+=1)r+=8*o+6*p<=a?t.charAt(s>>>6*(3-p)&63):n.b64Pad;return r}(i,n,o,p)};case"BYTES":return function(t){return function(t,i,a){let e,n,o="";const p=i/8,s=-1===a?3:0;for(e=0;e<p;e+=1)n=t[e>>>2]>>>8*(s+a*(e%4))&255,o+=String.fromCharCode(n);return o}(t,n,o)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(t){throw new Error(i)}return function(t){return function(t,i,a){let e;const n=i/8,o=new ArrayBuffer(n),p=new Uint8Array(o),s=-1===a?3:0;for(e=0;e<n;e+=1)p[e]=t[e>>>2]>>>8*(s+a*(e%4))&255;return o}(t,n,o)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(t){throw new Error(a)}return function(t){return function(t,i,a){let e;const n=i/8,o=-1===a?3:0,p=new Uint8Array(n);for(e=0;e<n;e+=1)p[e]=t[e>>>2]>>>8*(o+a*(e%4))&255;return p}(t,n,o)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function p(t){const i={outputUpper:!1,b64Pad:"=",outputLen:-1},a=t||{},e="Output length must be a multiple of 8";if(i.outputUpper=a.outputUpper||!1,a.b64Pad&&(i.b64Pad=a.b64Pad),a.outputLen){if(a.outputLen%8!=0)throw new Error(e);i.outputLen=a.outputLen}else if(a.shakeLen){if(a.shakeLen%8!=0)throw new Error(e);i.outputLen=a.shakeLen}if("boolean"!=typeof i.outputUpper)throw new Error("Invalid outputUpper formatting option");if("string"!=typeof i.b64Pad)throw new Error("Invalid b64Pad formatting option");return i}class s{constructor(t,i,a){const e=a||{};if(this.t=i,this.i=e.encoding||"UTF8",this.numRounds=e.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||1>this.numRounds)throw new Error("numRounds must a integer >= 1");this.o=t,this.h=[],this.u=0,this.l=!1,this.A=0,this.p=!1,this.U=[],this.R=[]}update(t){let i,a=0;const e=this.T>>>5,n=this.F(t,this.h,this.u),o=n.binLen,p=n.value,s=o>>>5;for(i=0;i<s;i+=e)a+this.T<=o&&(this.m=this.g(p.slice(i,i+e),this.m),a+=this.T);return this.A+=a,this.h=p.slice(a>>>5),this.u=o%this.T,this.l=!0,this}getHash(t,i){let a,e,n=this.B;const s=p(i);if(this.v){if(-1===s.outputLen)throw new Error("Output length must be specified in options");n=s.outputLen}const l=o(t,n,this.H,s);if(this.p&&this.C)return l(this.C(s));for(e=this.Y(this.h.slice(),this.u,this.A,this.I(this.m),n),a=1;a<this.numRounds;a+=1)this.v&&n%32!=0&&(e[e.length-1]&=16777215>>>24-n%32),e=this.Y(e,n,0,this.L(this.o),n);return l(e)}setHMACKey(t,i,a){if(!this.M)throw new Error("Variant does not support HMAC");if(this.l)throw new Error("Cannot set MAC key after calling update");const e=n(i,(a||{}).encoding||"UTF8",this.H);this.N(e(t))}N(t){const i=this.T>>>3,a=i/4-1;let e;if(1!==this.numRounds)throw new Error("Cannot set numRounds with MAC");if(this.p)throw new Error("MAC key already set");for(i<t.binLen/8&&(t.value=this.Y(t.value,t.binLen,0,this.L(this.o),this.B));t.value.length<=a;)t.value.push(0);for(e=0;e<=a;e+=1)this.U[e]=909522486^t.value[e],this.R[e]=1549556828^t.value[e];this.m=this.g(this.U,this.m),this.A=this.T,this.p=!0}getHMAC(t,i){const a=p(i);return o(t,this.B,this.H,a)(this.S())}S(){let t;if(!this.p)throw new Error("Cannot call getHMAC without first setting MAC key");const i=this.Y(this.h.slice(),this.u,this.A,this.I(this.m),this.B);return t=this.g(this.R,this.L(this.o)),t=this.Y(i,this.B,this.T,t,this.B),t}}function l(t,i){return t<<i|t>>>32-i}function c(t,i,a){return t^i^a}function r(t,i,a){return t&i^t&a^i&a}function m(t,i){const a=(65535&t)+(65535&i);return(65535&(t>>>16)+(i>>>16)+(a>>>16))<<16|65535&a}function u(t,i,a,e,n){const o=(65535&t)+(65535&i)+(65535&a)+(65535&e)+(65535&n);return(65535&(t>>>16)+(i>>>16)+(a>>>16)+(e>>>16)+(n>>>16)+(o>>>16))<<16|65535&o}function h(t){return[1732584193,4023233417,2562383102,271733878,3285377520]}function d(t,i){let a,e,n,o,p,s,h;const d=[];for(a=i[0],e=i[1],n=i[2],o=i[3],p=i[4],h=0;h<80;h+=1)d[h]=h<16?t[h]:l(d[h-3]^d[h-8]^d[h-14]^d[h-16],1),s=h<20?u(l(a,5),(x=e)&n^~x&o,p,1518500249,d[h]):h<40?u(l(a,5),c(e,n,o),p,1859775393,d[h]):h<60?u(l(a,5),r(e,n,o),p,2400959708,d[h]):u(l(a,5),c(e,n,o),p,3395469782,d[h]),p=o,o=n,n=l(e,30),e=a,a=s;var x;return i[0]=m(a,i[0]),i[1]=m(e,i[1]),i[2]=m(n,i[2]),i[3]=m(o,i[3]),i[4]=m(p,i[4]),i}function x(t,i,a,e){let n;const o=15+(i+65>>>9<<4),p=i+a;for(;t.length<=o;)t.push(0);for(t[i>>>5]|=128<<24-i%32,t[o]=4294967295&p,t[o-1]=p/4294967296|0,n=0;n<t.length;n+=16)e=d(t.slice(n,n+16),e);return e}class f extends s{constructor(t,i,a){if("SHA-1"!==t)throw new Error("Chosen SHA variant is not supported");super(t,i,a);const e=a||{};this.M=!0,this.C=this.S,this.H=-1,this.F=n(this.t,this.i,this.H),this.g=d,this.I=function(t){return t.slice()},this.L=h,this.Y=x,this.m=[1732584193,4023233417,2562383102,271733878,3285377520],this.T=512,this.B=160,this.v=!1,e.hmacKey&&this.N(function(t,i,a,e){const o="hmacKey must include a value and format";if(!i)throw new Error(o);if(void 0===i.value||!i.format)throw new Error(o);return n(i.format,i.encoding||"UTF8",a)(i.value)}(0,e.hmacKey,this.H))}}const g={"application/andrew-inset":["ez"],"application/appinstaller":["appinstaller"],"application/applixware":["aw"],"application/appx":["appx"],"application/appxbundle":["appxbundle"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/automationml-aml+xml":["aml"],"application/automationml-amlx+zip":["amlx"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cpl+xml":["cpl"],"application/cu-seeme":["cu"],"application/cwl":["cwl"],"application/dash+xml":["mpd"],"application/dash-patch+xml":["mpp"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdf":["fdf"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["*js"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/media-policy-dataset+xml":["mpf"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4","mpg4","mp4s","m4p"],"application/msix":["msix"],"application/msixbundle":["msixbundle"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-keys":["asc"],"application/pgp-signature":["sig","*asc"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/sql":["sql"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/watcherinfo+xml":["wif"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xfdf":["xfdf"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/aac":["adts","aac"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avci":["avci"],"image/avcs":["avcs"],"image/avif":["avif"],"image/bmp":["bmp","dib"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/dpx":["dpx"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm","jpgm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/jt":["jt"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/prc":["prc"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/u3d":["u3d"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/javascript":["js","mjs"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["md","markdown"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/wgsl":["wgsl"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","*jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["*mp4","mp4v","*mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};Object.freeze(g);var w={create:async function(t,i,a,e){const n={"Content-Type":"application/json",...e?.header||{}},o={method:i=(i||"GET").toUpperCase(),headers:n,mode:"cors",cache:"no-cache",redirect:"follow",credentials:"same-origin",referrerPolicy:"no-referrer"};return console.info("init.headers:",o.headers),"POST"!=i&&"PUT"!=i||(o.body=JSON.stringify(a||{})),fetch(new Request(t,o))}};class v{config={key:"",secret:"",bucket:"",region:""};constructor(t){this.config.key=t.key||"",this.config.secret=t.secret||"",this.config.bucket=t.bucket||"",this.config.region=t.region||""}async uploadObject(t,i){t=this.clean(t);const a=await this.requestConfig("PUT",t);let e={header:a.header};return await w.create(`${a.baseURL}/${t}`,"PUT",i,e)}async removeObject(t,i){t=this.clean(t);const a=await this.requestConfig("DELETE",t,i);let e={header:a.header};return await w.create(`${a.baseURL}/${t}`,"DELETE",void 0,e)}async requestConfig(t,i,a={}){let e=(new Date).toUTCString();a.Date=e,a["x-oss-date"]=e,a["Content-MD5"]="",a["Content-Type"]=this.contentType(i),a.Authorization=await this.signature(t,i,a);return{baseURL:`http://${this.config.bucket}.${this.config.region}.aliyuncs.com/`,header:a}}async signature(t,i,a){const e=[],n=[];Object.keys(a).forEach((t=>{let i=a[t];t.startsWith("x-oss")&&n.push(t+":"+i)})),e.push(t?.toUpperCase()||""),e.push(a["Content-Md5"]||""),e.push(a["Content-Type"]||""),e.push(a.Date||""),e.push(...n.sort()),e.push(`/${this.config.bucket}/${i}`);let o=new f("SHA-1","TEXT",{hmacKey:{value:this.config.secret,format:"TEXT"}}).update(e.join("\n")).getHash("B64").toString();return`OSS ${this.config.key}:${o}`}clean(t){return t.split("/").filter((t=>0!=t.length)).join("/")}contentType(t){let i=t.split(".").splice(-1);if(1!=i.length)return"";let a="";return Object.keys(g).forEach((t=>{let e=g[t];Array.isArray(e)&&e.forEach((e=>{e==i[0]?.toLowerCase()&&(a=t)}))})),a}}const b={multiple:!1,accept:"*"};class j{option;input;emitter;constructor(t=b){var i;this.option=t,this.emitter=null,this.emitter={all:i=i||new Map,on(t,a){const e=i.get(t);e?e.push(a):i.set(t,[a])},off(t,a){const e=i.get(t);e&&(a?e.splice(e.indexOf(a)>>>0,1):i.set(t,[]))},emit(t,a){let e=i.get(t);e&&e.slice().map((t=>{t(a)})),e=i.get("*"),e&&e.slice().map((i=>{i(t,a)}))}},this.input=null,this.input=((t,i)=>{const a=document.createElement("input");return a.type="file",a.style.display="none",a.accept=t.accept||"*",a.multiple=t.multiple||!1,a.addEventListener("change",(async t=>{const e=t.target.files;if(e&&0!=e.length)try{i.emit("success",{file:Array.from(e),state:!0,message:""})}catch(t){i.emit("failure",{file:[],state:!1,message:String(t)})}finally{a.value=""}else i.emit("failure",{file:[],state:!1,message:"The file list length is 0"})})),document.body.appendChild(a),a})(this.option,this.emitter)}choose(){this.input?.click();let t=this.emitter;return this.input&&this.emitter?new Promise(((i,a)=>{t?.on("success",(t=>{console.log("file",t),i(t)})),t?.on("failure",(t=>{console.log("failure",t),a(t)}))})):Promise.reject("input loss | emitter loss")}}class y{bin;constructor(t){this.bin=new v(t)}async choose(){let t=new j;return await t.choose()}async upload(t,i){return this.bin.uploadObject(t,i)}async remove(t){return this.bin.removeObject(t)}async copy(t,i){console.log(t),console.log(i)}}export{y as default};
